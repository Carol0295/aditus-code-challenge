import{_,r as l,b as H,o,c as i,a as s,w as y,v as M,F as D,f as p,t as u,g as x,h as V,i as F,j as R,k as q,d as B,e as L}from"./index-CNA75Qyt.js";const N={name:"HardwareReservation",setup(){const d=l([]),t=l({}),g=l({}),r={},f=l({}),h=l([]),e=l([]),m=l(""),n=l(""),E=async()=>{try{const[v,a]=await Promise.all([fetch("hardware"),fetch("/hardware/eventsForReservation")]);d.value=await v.json();const w=await a.json();w.forEach(c=>{const S=new Date(c.eventStartDate),k=new Date(c.eventEndDate);c.eventStartDate=S.toLocaleDateString("de-DE"),c.eventEndDate=k.toLocaleDateString("de-DE")}),h.value=w,d.value!=null&&d.value.forEach(c=>{t.value[c.id]=0})}catch(v){console.error("Error fetching hardware data:",v)}},b=async()=>{if(e.value.length>0){const v=e.value.filter(a=>t.value[a]>0).map(a=>({hardwareId:a,quantity:t.value[a]}));if(v.length>0)try{const a={eventId:f.value.eventId,hardwareList:v};(await fetch("/reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(m.value="Die Reservierung wurde gemacht, eine Freigabe steht aus. Bitte aktuelle Reservierungen Seite ansehen",n.value=""):(n.value="Die Reservierungsdatum ist zu kurzfristig. Die Reservierung darf nur mindestens 4 Woche vor Veranstaltungsdurchführung getätigt.",m.value="")}catch(a){n.value="Fehler bei der Serververbindung.",console.error("Error:",a)}else n.value="Bitte wählen Sie Hardware mit Menge zur Reservierung aus.",m.value=""}else n.value="Bitte wählen Sie Hardware aus, um eine Reservierung zu machen."};return H(E),{hardwareOptions:d,selectedHardware:e,selectedEvent:f,eventsForReservation:h,hardwareId:g,quantity:t,reservationRequest:r,reserveHardware:b,successMsg:m,errorMsg:n}}},j=["value"],z=["value"],C=["onUpdate:modelValue","max"],O={key:0,class:"success-message"},T={key:1,class:"error-message"};function U(d,t,g,r,f,h){return o(),i(D,null,[t[5]||(t[5]=s("h2",null,"Reservierung",-1)),t[6]||(t[6]=s("p",null,"Achtung: Die Reservierung darf nur mindestens 4 Woche vor Veranstaltungsdurchführung getätigt werden.",-1)),s("form",{onSubmit:t[2]||(t[2]=q((...e)=>r.reserveHardware&&r.reserveHardware(...e),["prevent"]))},[s("div",null,[t[3]||(t[3]=s("label",{for:"myEvent"},"Bitte wählen Sie ein Event aus der Liste aus. ",-1)),y(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedEvent=e),id:"myEvent",required:""},[(o(!0),i(D,null,p(r.eventsForReservation,e=>(o(),i("option",{key:e.eventId,value:e},u(e.eventName)+" - ( "+u(e.eventStartDate)+" bis "+u(e.eventEndDate)+" ) ",9,j))),128))],512),[[M,r.selectedEvent]])]),(o(!0),i(D,null,p(r.hardwareOptions,(e,m)=>(o(),i("div",{key:e.id},[s("label",null,[y(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[1]||(t[1]=n=>r.selectedHardware=n)},null,8,z),[[x,r.selectedHardware]]),V(" "+u(e.name)+" ("+u(e.totalAmount)+" verfügbar) ",1),r.selectedHardware.includes(e.id)?y((o(),i("input",{key:0,type:"number","onUpdate:modelValue":n=>r.quantity[e.id]=n,min:0,max:e.totalAmount},null,8,C)),[[F,r.quantity[e.id],void 0,{number:!0}]]):R("",!0)])]))),128)),t[4]||(t[4]=s("button",{type:"submit"},"Reservieren",-1))],32),r.successMsg?(o(),i("div",O,u(r.successMsg),1)):r.errorMsg?(o(),i("div",T,u(r.errorMsg),1)):R("",!0)],64)}const A=_(N,[["render",U]]),W=B({__name:"ReservationView",setup(d){return(t,g)=>(o(),i("main",null,[L(A)]))}});export{W as default};
